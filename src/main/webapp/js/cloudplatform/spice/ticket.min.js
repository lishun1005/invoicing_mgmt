"use strict";function MGF1(a,b){var c,d,e,f,g;for(c=0,e=0;e<a.length;c++){for(f=new String,d=0;d<b.length;d++)f+=String.fromCharCode(b[d]);for(f+=String.fromCharCode(255&c>>24),f+=String.fromCharCode(255&c>>16),f+=String.fromCharCode(255&c>>8),f+=String.fromCharCode(255&c),g=rstr_sha1(f),d=0;d<g.length&&e<a.length;d++,e++)a[e]=g.charCodeAt(d)}}function RSA_padding_add_PKCS1_OAEP(a,b,c){var f,g,h,i,j,k,l,m,d=new Array(SHA_DIGEST_LENGTH),e=new SecureRandom;if(e.nextBytes(d),f=a-1-d.length,g=new Array(f),h=f-b.length-1,void 0===c&&(c=""),SHA_DIGEST_LENGTH>h)return console.log("Error - data too large for key size."),null;for(i=0;h>i;i++)g[i]=0;for(j=rstr_sha1(c),i=0;i<j.length;i++)g[i]=j.charCodeAt(i);for(g[h]=1,i=0;i<b.length;i++)g[i+h+1]=b.charCodeAt(i);if(k=new Array(f),MGF1(k,d)<0)return null;for(i=0;i<k.length;i++)g[i]^=k[i];if(l=Array(SHA_DIGEST_LENGTH),MGF1(l,g)<0)return null;for(i=0;i<l.length;i++)d[i]^=l[i];for(m=new String,m+=String.fromCharCode(0),i=0;i<d.length;i++)m+=String.fromCharCode(d[i]);for(i=0;i<g.length;i++)m+=String.fromCharCode(g[i]);return m}function asn_get_length(a,b){var c=a[b++];if(c>128){if(129!=c)return console.log("Error:  we lazily don't support keys bigger than 255 bytes.  It'd be easy to fix."),null;c=a[b++]}return[b,c]}function find_sequence(a,b){var c;return b=b||0,48!=a[b++]?(console.log("Error:  public key should start with a sequence flag."),null):(c=asn_get_length(a,b),c?c:null)}function create_rsa_from_mb(a,b){var d,f,g,h,c=new Uint8Array(a),e=find_sequence(c,b);if(!e)return null;if(b=e[0],e=find_sequence(c,b),!e)return null;if(b=e[0]+e[1],3!=c[b++])return console.log("Error: expecting bit string next."),null;if(d=asn_get_length(c,b),!d)return null;if(b=d[0],0!=c[b]&&48!=c[b+1])return console.log("Error: unexpected values in bit string."),null;if(e=find_sequence(c,b+1),!e)return null;if(b=e[0],2!=c[b++])return console.log("Error: expecting integer n next."),null;if(d=asn_get_length(c,b),!d)return null;for(b=d[0],f=new Array(d[1]),g=0;g<d[1];g++)f[g]=c[b+g];if(h=new RSAKey,h.n=new BigInteger(f),b+=d[1],2!=c[b++])return console.log("Error: expecting integer e next."),null;if(d=asn_get_length(c,b),!d)return null;for(b=d[0],h.e=c[b++],g=1;g<d[1];g++)h.e<<=8,h.e|=c[b++];return h}function rsa_encrypt(a,b){var c,f,g,h,i,d=[],e=RSA_padding_add_PKCS1_OAEP(a.n.bitLength()+7>>3,b);if(!e)return null;for(f=new Array(e.length),c=0;c<e.length;c++)f[c]=e.charCodeAt(c);for(g=new BigInteger(f),h=a.doPublic(g),i=h.toString(16),0!=(1&i.length)&&(i="0"+i),c=0;c<i.length;c+=2)d[c/2]=parseInt(i.substring(c,c+2),16);return d}var SHA_DIGEST_LENGTH=20;
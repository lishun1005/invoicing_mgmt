"use strict";function SpiceWireReader(a,b){this.sc=a,this.callback=b,this.needed=0,this.buffers=[],this.sc.ws.wire_reader=this,this.sc.ws.binaryType="arraybuffer",this.sc.ws.addEventListener("message",wire_blob_catcher)}function wire_blob_catcher(a){DEBUG>1&&console.log(">> WebSockets.onmessage"),DEBUG>1&&console.log("id "+this.wire_reader.sc.connection_id+"; type "+this.wire_reader.sc.type),SpiceWireReader.prototype.inbound.call(this.wire_reader,a.data)}SpiceWireReader.prototype={inbound:function(a){var c,d;if(0==this.needed)return this.buffers.push(a),void 0;for(0==this.buffers.length&&a.byteLength>=this.needed?(a.byteLength>this.needed&&(this.buffers.push(a.slice(this.needed)),a=a.slice(0,this.needed)),this.callback.call(this.sc,a,this.saved_msg_header||void 0)):this.buffers.push(a);this.buffers.length>1&&this.buffers[0].byteLength<this.needed;)c=this.buffers.shift(),d=this.buffers.shift(),this.buffers.unshift(combine_array_buffers(c,d));for(;this.buffers.length>0&&this.buffers[0].byteLength>=this.needed;)a=this.buffers.shift(),a.byteLength>this.needed&&(this.buffers.unshift(a.slice(this.needed)),a=a.slice(0,this.needed)),this.callback.call(this.sc,a,this.saved_msg_header||void 0)},request:function(a){this.needed=a},save_header:function(a){this.saved_msg_header=a},clear_header:function(){this.saved_msg_header=void 0}};
"use strict";var SpiceSimulateCursor={cursors:new Array,unknown_cursors:new Array,warned:!1,add_cursor:function(a,b){SpiceSimulateCursor.cursors[a]=b},unknown_cursor:function(a,b){SpiceSimulateCursor.warned||(SpiceSimulateCursor.warned=!0,alert("Internet Explorer does not support dynamic cursors.  This page will now simulate cursors with images, which will be imperfect.  We recommend using Chrome or Firefox instead.  \n\nIf you need to use Internet Explorer, you can create a static cursor file for each cursor your application uses.  View the console log for more information on creating static cursors for your environment.")),SpiceSimulateCursor.unknown_cursors[a]||(SpiceSimulateCursor.unknown_cursors[a]=b,console.log("Unknown cursor.  Simulation required.  To avoid simulation for this cursor, create and include a custom javascript file, and add the following line:"),console.log('SpiceCursorSimulator.add_cursor("'+a+'"), "<your filename here>.cur");'),console.log("And then run following command, redirecting output into <your filename here>.cur:"),console.log("php -r \"echo urldecode('"+b+"');\""))},simulate_cursor:function(a,b,c,d){var f,e=hex_sha1(d+" "+b.header.hot_spot_x+" "+b.header.hot_spot_y);"undefined"!=typeof SpiceSimulateCursor.cursors&&"undefined"!=typeof SpiceSimulateCursor.cursors[e]&&(f="url("+SpiceSimulateCursor.cursors[e]+"), default",c.style.cursor=f),"auto"==window.getComputedStyle(c,null).cursor?(SpiceSimulateCursor.unknown_cursor(e,SpiceSimulateCursor.create_icondir(b.header.width,b.header.height,b.data.byteLength,b.header.hot_spot_x,b.header.hot_spot_y)+d),document.getElementById(a.parent.screen_id).style.cursor="none",a.spice_simulated_cursor||(a.spice_simulated_cursor=document.createElement("img"),a.spice_simulated_cursor.style.position="absolute",a.spice_simulated_cursor.style.display="none",a.spice_simulated_cursor.style.overflow="hidden",a.spice_simulated_cursor.spice_screen=document.getElementById(a.parent.screen_id),a.spice_simulated_cursor.addEventListener("mousemove",SpiceSimulateCursor.handle_sim_mousemove),a.spice_simulated_cursor.spice_screen.appendChild(a.spice_simulated_cursor)),a.spice_simulated_cursor.src="data:image/png,"+d,a.spice_simulated_cursor.spice_hot_x=b.header.hot_spot_x,a.spice_simulated_cursor.spice_hot_y=b.header.hot_spot_y,a.spice_simulated_cursor.style.pointerEvents="none"):a.spice_simulated_cursor&&(a.spice_simulated_cursor.spice_screen.removeChild(a.spice_simulated_cursor),delete a.spice_simulated_cursor)},handle_sim_mousemove:function(a){var c=SpiceSimulateCursor.duplicate_mouse_event(a,this.spice_screen);return this.spice_screen.dispatchEvent(c)},duplicate_mouse_event:function(a){var c=document.createEvent("mouseevent");return c.initMouseEvent(a.type,!0,!0,a.view,a.detail,a.screenX,a.screenY,a.clientX,a.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.button,a.relatedTarget),c},ICONDIR:function(){},ICONDIRENTRY:function(a,b,c,d,e){this.width=a,this.height=b,this.bytes=c,this.hot_x=d,this.hot_y=e},create_icondir:function(a,b,c,d,e){var f,k,l,g=new SpiceSimulateCursor.ICONDIR,h=new SpiceSimulateCursor.ICONDIRENTRY(a,b,c,d,e),i=new ArrayBuffer(g.buffer_size()+h.buffer_size()),j=g.to_buffer(i);for(j=h.to_buffer(i,j),k=new Uint8Array(i),l="",f=0;j>f;f++)l+="%",k[f]<16&&(l+="0"),l+=k[f].toString(16);return l}};SpiceSimulateCursor.ICONDIR.prototype={to_buffer:function(a,b){b=b||0;var c=new SpiceDataView(a);return c.setUint16(b,0,!0),b+=2,c.setUint16(b,2,!0),b+=2,c.setUint16(b,1,!0),b+=2},buffer_size:function(){return 6}},SpiceSimulateCursor.ICONDIRENTRY.prototype={to_buffer:function(a,b){b=b||0;var c=new SpiceDataView(a);return c.setUint8(b,this.width),b++,c.setUint8(b,this.height),b++,c.setUint8(b,0),b++,c.setUint8(b,0),b++,c.setUint16(b,this.hot_x,!0),b+=2,c.setUint16(b,this.hot_y,!0),b+=2,c.setUint32(b,this.bytes,!0),b+=4,c.setUint32(b,b+4,!0),b+=4},buffer_size:function(){return 16}};